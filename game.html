<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="UTF-8">
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<title>AâˆžZ | Transmission</title>

<style>
html, body {
  height: 100%;
  margin:0;
  padding:0;
  background:#000;
  font-family:'Courier New', monospace;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
  text-align:center;
}

#particles-js {
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    z-index:0;
    pointer-events:none;
}

#output { 
    opacity:1;
    transform: translateY(0);
    white-space: pre-wrap;
    z-index:10;
    color: #eaeaea;
    text-shadow: 0 0 8px rgba(255,255,255,0.7);
}


/* Typewriter output */
.line {
    margin-bottom:0.7em;
    opacity:0;
    filter: blur(10px);
    transform: translateY(20px);
    transition: opacity 5s ease, filter 5s ease, transform 5s ease;
}
.line.visible {
    opacity:1;
    filter: blur(0);
    transform: translateY(0);
}

/* Strong glitch */
.glitch {
    font-weight:bold;
    letter-spacing:1px;
    color:#00ff00;
    text-shadow:none;
    animation: glitchAnim 0.12s steps(2, jump-end) infinite;
}
@keyframes glitchAnim {
    0% { transform:translate(1px, -1px); }
    50% { transform:translate(-2px, 2px); }
    100% { transform:translate(1px, -1px); }
}

.shake {
    animation: shakeAnim 0.35s ease-in-out;
}
@keyframes shakeAnim {
    0% { transform:translateX(0); }
    20% { transform:translateX(-4px); }
    40% { transform:translateX(4px); }
    60% { transform:translateX(-3px); }
    80% { transform:translateX(3px); }
    100% { transform:translateX(0); }
}

#fade-black {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000;
  pointer-events: none;
  opacity: 0;
  z-index: 999;
  transition: opacity 5s ease;
}

#myVideo {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1000; 
}
</style>
</head>

<body>
<div id="particles-js"></div>
<div id="output"></div>

<video id="myVideo" width="640" height="360" muted>
    <source src="ðŸŒ€ðŸŽ¶.mp3.MP4" type="video/mp4">
</video>

<div id="fade-black"></div>

<script>
/* ---- TYPEWRITER EFFECT WITH FADE-IN ---- */
function typeLine(text, callback) {
    const container = document.getElementById("output");
    const line = document.createElement("div");
    line.className = "line";
    container.appendChild(line);

    setTimeout(() => line.classList.add('visible'), 50);

    let i = 0;
    function type() {
        if (i < text.length) {
            line.textContent += text[i];
            i++;
            const jitter = Math.random() * 80;
            setTimeout(type, 113 + jitter);
        } else {
            if (callback) setTimeout(callback, 200);
        }
    }
    type();
}

/* ---- RANDOM GLITCH FX ---- */
function glitchFx() {
    const out = document.getElementById("output");
    const g = document.createElement("div");
    g.className = "line glitch";
    g.textContent = "!! SIGNAL DISTORTION DETECTED !!";
    out.appendChild(g);
    setTimeout(() => g.remove(), 500);
}

/* ---- MASTER SEQUENCE ---- */
function runSequence(lines, index = 0) {
    if (index >= lines.length) {
        const fade = document.getElementById("fade-black");
        fade.style.opacity = 1;

        requestAnimationFrame(() => {
            window.location.href = "index.html";
        });
        return;
    }

    typeLine(lines[index], () => {
        if (Math.random() < 0.22) glitchFx();

        if (lines[index].includes("FAILED") || lines[index].includes("Unknown")) {
            const last = document.querySelector(".line:last-child");
            last.classList.add("shake");
        }

        runSequence(lines, index + 1);
    });
}

/* ---- FETCH USER DATA + START ---- */
fetch("https://api.ipify.org?format=json")
  .then(r => r.json())
  .then(data => {
      const lines = [
          "It started on a night that shouldnâ€™t have carried any echoesâ€¦",
          "No timestamp. No origin. No sender signature.",
          "A message that had been trying to arrive for 12 years,",
          "",
          "Tonightâ€¦",
          "",
          ">>> Decrypting frozen message...",
          "Sender: Only Brother",
          "To: Mamy",
          "",
          "â€œMamyâ€¦",
          "Why didnâ€™t you answer my callsâ€¦?â€",
          "",
          "Opa hasnâ€™t woken up.",
          "Before he slept he said:",
          "   â€˜Your Dady will be late.â€™",
          "",
          "Message Age: 12 years",
          "Delivery Status: FAILED",
          "Reason: No recipient detected.",
          "-----",
          "Connection unstable...",
          "Why? Continue? Let's see~>N...."
      ];
      runSequence(lines);
  })
  .catch(() => {
      runSequence([
          "[ AâˆžZ / FAILURE ]",
          "Metadata retrieval failed...",
          "But something recognized you anyway.",
          "",
          "Closing connection..."
      ]);
  });

window.addEventListener('load', () => {
    setTimeout(() => {
        const video = document.getElementById('myVideo');
        video.style.display = 'block';
        video.style.opacity = 0;
        video.style.transition = 'opacity 2s ease'; 
        requestAnimationFrame(() => video.style.opacity = 1);
        video.play(); 
    }, 19000);  
});
</script>

<!-- CINEMATIC SCI-FI PARTICLES -->
<script>
particlesJS("particles-js",{
  particles:{
    number:{ value:200, density:{ enable:true, value_area:1800 } },
    color:{ value:"#ffffff" },
    shape:{ type:"circle" },
    opacity:{ value:0.7, random:true, anim:{ enable:true, speed:0.5, opacity_min:0.2, sync:false } },
    size:{ value:1.5, random:true, anim:{ enable:true, speed:2, size_min:0.3, sync:false } },
    line_linked:{ enable:false },
    move:{ enable:true, speed:0.5, direction:"none", random:true, straight:false, out_mode:"out" }
  },
  interactivity:{
    detect_on:"canvas",
    events:{ onhover:{ enable:false }, onclick:{ enable:false } }
  },
  retina_detect:true
});
</script>

</body>
</html>