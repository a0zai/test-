<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAFAT Ghost Butterfly Engine</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; cursor: crosshair; }
        canvas { display: block; filter: contrast(120%) brightness(110%); }
    </style>
</head>
<body>
    <canvas id="matrix-canvas"></canvas>
    <script>
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');

        let width, height, columns;
        const fontSize = 16;
        let drops = [];
        let speeds = [];

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            columns = Math.floor(width / fontSize);
            drops = Array(columns).fill(1).map(() => Math.random() * -100);
            speeds = Array(columns).fill(1).map(() => 0.5 + Math.random() * 0.5);
        }

        const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789アァカサタナハマヤャラワガザダバパイィキシチニヒミ";

        function getButterflyScale(t) {
            return (Math.exp(Math.sin(t)) - 2 * Math.cos(4 * t) + Math.pow(Math.sin((2 * t - Math.PI) / 24), 5));
        }

        function draw(time) {
            ctx.fillStyle = "rgba(0, 0, 0, 0.15)";
            ctx.fillRect(0, 0, width, height);

            const t = time * 0.001;
            const cx = width / 2;
            const cy = height / 2;
            const bScale = Math.min(width, height) / 10;

            for (let i = 0; i < drops.length; i++) {
                const x = i * fontSize;
                const y = drops[i] * fontSize;
                const char = alphabet[Math.floor(Math.random() * alphabet.length)];

                const dx = (x - cx) / bScale;
                const dy = (y - cy) / bScale;
                
                const angle = Math.atan2(dx, -dy);
                const dist = Math.sqrt(dx * dx + dy * dy);
                const limit = getButterflyScale(angle + Math.sin(t) * 0.2);

                if (dist < limit) {
                    ctx.fillStyle = "#fff";
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = "#00ffcc";
                    ctx.font = `bold ${fontSize + 4}px monospace`;
                    drops[i] += speeds[i] * 2.5;
                } else {
                    ctx.fillStyle = "rgba(0, 255, 150, 0.15)";
                    ctx.shadowBlur = 0;
                    ctx.font = `${fontSize}px monospace`;
                    drops[i] += speeds[i];
                }

                ctx.fillText(char, x, y);

                if (drops[i] * fontSize > height) {
                    drops[i] = 0;
                    speeds[i] = 0.5 + Math.random() * 0.5;
                }
            }
            requestAnimationFrame(draw);
        }

        window.addEventListener('resize', init);
        init();
        requestAnimationFrame(draw);
    </script>
</body>
</html>